# 考虑分红送股红利税等情况后如何准确在回测过程中计算买入成本？

首先，不考虑用平台的复权因子等数据计算最初“实际”买入成本。自然也不考虑用前复权价格就算买入成本。主要是不希望输入过多间接比率数据。希望用更多直接数据代入运算。

目的，区分红利收入和股票买卖差价收入

问题如下：

1、不考虑现金股利税
如果2015年5月15日按照100元卖入A股票。该股票截止到今日经历了以下分红或送股
现金分红1元
现金分红1.5元
现金分红2元 送红股（10送3）
一股拆10股
现金分红2元

则当初买入成本是否因该这样计算？
（（（100-1-1.5-2）/1.3）/10）-2

如果计算方法正确。可否提供一下代码思路。如何让程序自动根据不同的分红送股方案按照正确的四则运算顺序计算买入成本价？

2、考虑现金股利

现金分红1元 税后0.8
现金分红1.5元 税后1.2
现金分红2元 税后1.6 送红股（10送3）
一股拆10股
现金分红2元 税后1.6

则当初买入成本是否因该这样计算？
（（（100-0.8-1.2-1.6）/1.3）/10）-1.6

3、如果采用“不考虑现金股利税”的方案，计算出来的价格（不止一只股票有这种情况）与2015年5月15日“前复权”价格不同。那么原因是什么的？造成差异的原因是计算方法的哪些差异造成的？