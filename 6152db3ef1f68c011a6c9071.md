# 基于朴素贝叶斯选股策略

    最近学习了朴素贝叶斯算法，其实在优矿社区里也有很多的大佬分享过自己的朴素贝叶斯策略,自己也想尝试一下，我会把我的策略过程尽可能讲的详细一点，和大家一起分享交流。具体的朴素贝叶斯算法参考[https://www.bilibili.com/video/BV1qt41117Hg?spm_id_from=333.999.0.0](http://)
    应用在选股上简单来说就是我已经知道股票池中的股票它具备某些特征(比如说PE,PB等因子)，以及标签(这些具备这些因子在过去一段时间内的涨跌幅)，那么对于未来一段时间，对于股票之中股票更新的特征(因子)，它在未来一段时间的上涨还是下跌的概率是多少？这就是通过先验概率来求得后验概率，即经典的贝叶斯公式。
    那么第一步就是要先得到股票的特征和标签，本策略回测区间为2019年1月1日-2020年1月1日，选取的股票池为上证50，特征(因子)为每一只股票在30个交易日前的市现率PCF、市销率PS、ROA。标签选取每只股票过去一个月超过沪深300收益的超额收益率，超额收益率>0,则给予该股票‘g’标签，超额收益率<0,则给予该股票‘b’标签。
    1.获得沪深300指数前三十个交易日的涨跌幅。yesterday为前一个交易日的日期，ago为前一个交易日再往前推三十个交易日的日期，前者除以后者便可得到一个月的涨跌幅，记为R。
    2.获得股票池成分股过去三十个交易日涨跌幅。这里想得到两列的Dataframe，第一列为各成分股代码，第二列为过去三个个交易日收益率zRate列。最后对zRate列进行判断，如果大于R，则更改标签为1，小于R，则标签记为0.
    3.获得回测日前一个的PCF、PS、ROA因子，并对PCF、PS取倒数。
    4.将得到的因子FFactor和标签ddataset取前80%的数据作为训练集， Xtrain为前80%行因子的训练集，Ytrain为前80%行因子的测试集。Xtest为后20%行因子的训练集，Ytest为后20%行标签的测试集。这里需转化为列表的格式。
    5.优矿有自带的高斯贝叶斯包，这里可以直接调用，需要详细的计算过程可以参考我上面发的链接。调用该包可以得到对Xtest进行预测，并于真实的预测值进行比较，在下方输出的日志可以看到，某些时候预测率还是挺高的。
    第二步就是要获得前一个交易日的因子，并对该因子进行预测，可以得到预测出来的各成分股标签为'g'或'b'，选择标签为'g'的股票买入，因为我预测他在未来一个月的收益率会超过沪深300。
    以上就是整个策略的全部了，可以看到，回测出来的结果还不错。不过由于本人刚学习量化不久，对很多算法还不是很了解，本策略也存在很多的不足之处，程序也比较繁琐，希望大家能够多多指点，欢迎交流！