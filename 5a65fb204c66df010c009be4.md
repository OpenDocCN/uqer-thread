# 【量化投资这一年】六年十倍--基于市场择时轮动策略的探究

**市场择时轮动**
    市场择时轮动算是一种动量反转策略，A股主板和创业板涨跌并不是同步的，甚至会出现跷跷板效应。这是本策略存在的基础条件。当上证指数表现较好时，意味着A股主板股票表现较好，在A股中选股。若创业板指数表现较好，在创业板中选股持股。若两个指数表现都不好，则选择清仓，从而扩大收益的同时降低回撤的风险。单一策略单一市场回撤难控制，选股范围也会受到限制，这是选择研究市场择时轮动的原因。
    
**非周期A股市场选股逻辑：**
    格雷厄姆成长股内在价值公式：value = E * (8.5 + 2 * R) 其中 E 表示每股收益（EPS），决定了公司内在价值基准，R 表示预期收益增长率，用净利润同比增长率代替，体现了公司未来的盈利能力；数值 8.5 被格雷厄姆认为是一家预期收益增长率为 0 的公司的合理市盈率；因此 value 给出了合理的估值水平。
1、为什么0增长给8.5倍估值？
答：8.5倍PE，倒数为11.76%，这个收益率数据来自哪里？
表3-3  标准普尔综合指数个年份数据（ 表格来源：《聪明的投资者》 P55 ）
 ![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/09fdfaa0-ff79-11e7-b54b-0242ac140002)
2、为什么是两倍预期增长率
![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/1f400ce6-ff79-11e7-b54b-0242ac140002)
答：8.5+2×5.1=18.7 计算值与当时平均市盈率18.1非常接近了，2倍，这个数据，是格老通过当时市场增长平均情况倒推过来的，我们可以回顾整个公式了：
第一，0增长率对应PE=高等级债券利息+市场三年利润率
第二，增长率倍数计算要根据整个市场为参照。
市场平均市盈率=【（高等级债券利息+市场三年利润率）（+倍数×市场平均增长率）】
成长股价值=当期（扣非）利润×【（高等级债券利息+市场三年利润率）+（倍数×7-10年的预期增长率）】
格雷厄姆在估算成长股价值时候主要参照依据是：高等债券利息，市场平均值（包含利润率、市盈率等）。

**创业板市场选股逻辑**
 迈克尔.喜伟的收益型投资法选股在创业板回测表现较好，其选股条件如下：
1、股息率大于市场平均值 数据来源： EquDivGet ， 公式计算
2、每股收益增长率大于市场平均值 数据来源： FdmtISGet，EPS 手工计算
3、负债与股东权益之比（产权比率）小于市场平均值 数据来源： MktStockFactorsOneDayGet，DebtEquityRatio
4、流动比率大于市场平均值 数据来源： MktStockFactorsOneDayGet，CurrentRatio
5、市盈率为正且小于市场平均值 数据来源： MktStockFactorsOneDayGet ，PE

**本策略初始条件如下：**
股票池：非周期A股和创业板轮动
最大持股数量：10股
初始资金：10万  
调仓频率：每周调仓(Weekly(1))  
模型：市场轮动择时
核心策略逻辑：格式成长公式选股、收益型投资法--迈克尔喜伟（或者多因子策略）

**量化时遇到的问题：**
1、为什么选用非周期A股？
格式成长公式适用于成长型的公司，非常适合对成长型公司的股票价值评估。马克思说过:“任何真理都有自己适用的条件和范围。”在量化投资时，倘若不在合适的范围内进行操作，就不是一个好策略。
申万行业分类如下： 
    #{'建筑建材':801060,'建筑材料':801061,'建筑装饰':801720,'机械设备':801070,'电气设备':801730,'交运设备':801090,'国防军工':801740,'汽车':801880,'信息设备':801100,'信息服务':801220,'计算机':801750,'传媒':801221,'通信':801770,'金融服务':801190,'银行':801780,'非银金融':801790,'钢铁':801040,'休闲服务':801210,'农林牧渔':801010,'采掘':801020,'化工':801030,'有色金属':801050,'电子':801080,'家用电器':801110,'食品饮料':801120,'纺织服装':801130,'轻工制造':801140,'医药生物':801150,'公用事业':801160,'交通运输':801170,'房地产':801180,'商业贸易':801200,'综合':801230}
   去掉了许多周期性行业，这些行业利润基础不稳定，具体如下： 
![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/859a288a-ff7b-11e7-958b-0242ac140002)

2、遇到的未来信息陷阱
当策略用到股权登记日时，小心存在未来函数，在社区中使用到股权登记日的策略很多中枪的。详细见我发的另一个帖子，网址如下：
https://uqer.datayes.com/community/share/59f73f2a0f66ae010861d4eb

**策略回测结果分析：**
![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/ce1c8554-ff7f-11e7-958b-0242ac140002)
![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/d5aa70d8-ff7f-11e7-958b-0242ac140002)
    从上面两个策略2012-2017回测结果可以看出。基本可以躲开大盘的大幅度回调。特别是2015年，基板上躲开了股市的暴跌，同时不会错过后期的反弹。但是在震荡市比如2017年表现一般。后期我们可以在此基础上通过其他择时判断方法不断优化。

**同类型市场择时轮动策略模拟表现**
![图片注释](http://storage-uqer.datayes.com/5874e6e023a7d60051a36d00/461d6f9a-ff81-11e7-b54b-0242ac140002)
由于开始模拟到现在才70多天，还需要时间进一步的验证。

**对优矿的建议：**
1、策略模拟时会出现由于内存不足而无法正常运行的情况，HS300为股票池稍微好点。是否可以增加模拟内存，还是需要买优矿专业版？
2、是否考虑增加类似于聚宽的策略商城？增加编写、分享量化策略的动力。

下面是选出的两个市场轮动代码，有详细注释容易理解，非周期A股汇总详见文章末尾附件。

