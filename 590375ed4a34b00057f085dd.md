# 关系图谱分析与网络中心度选股——研报复现（第一集）

从寒假来到优矿学习python已经差不多半年了，在社区看到了很多非常有内容的帖子，现在想把自己总结一下，所以就发了这帖子，望大家能够通过这个帖子给我一些建议。
    *废话不多说，先简略地说一下研报的做法的主干：
    研报通过做一个个股对应申万一级行业指数收益率（X1）和对应大盘收益率（X2）对个股收益率（Y）的20日多元回归，得到拟合优度（Rsquare），然后对拟合优度做正态化处理得到P=ln（Rsquare/（1-Rsquare）），企图利用P来发现个股相对于大盘的异动情况，再分别拿处于P的百分位的股票作组合验证P的有效性。(本文中用的是Rsquare不是P)
    
    由于优矿中没有API可以直接通过股票交易码得到对应的行业数据和对应大盘数据，所以只能采取曲线救国的方式编个get_industry 得到股票对应的申万一级行业分类的indexSymbol，再利用DataAPI.MktIdxdGet获取对应的行业收益率（某些行业在优矿是没有14年之前的数据的）
    在得到全A股的Rsquare的dataframe后，就可以使用pd.merge来合并对应时间的股票收盘价了。
    
    在考虑使用收益率作回归之前，曾经一度想用收盘价作为回归的数据，可效果真的很差，自己思考了一下，总结原因是因为股票与股票 和 股票与大盘或指数 是不处于一个价格维度的，有可能有些股票一天上涨10%就涨了10块而另外一股票就只能1块，所以拟合的效果非常地不好。当X1,X2,Y的数值都处于一个区间时，拟合的效果就比较能体现股票的异动了。
    
    **在本帖，并没有现成的图，可能是学艺不精吧，总画不了跟excel画出来的一样，所以各位看官麻烦一点使用第二个代码框的代码得到一个excel后在本地自己画一下吧。帖中唯一的图是第二代码框16行stk = R.columns[50]的R平方和股价的运动轨迹**![图片注释](http://storage-uqer.datayes.com/589ee010c1e3cc00577fddc1/5001bf96-2c34-11e7-864b-0242ac140004)
    
    
    由于回测需要更大的内存，我只能攒够积分换内存以后才能给你们分享回测的结果，所以兄弟们请期待续集
    后续可能会加入更多的细节，比如研究选股组合的市值，IC等等。
    **感谢你们的观看，如果有什么意见的话可以留言！谢谢！！**
    
    
—————————————————————————————————————————2017年5月5号————更新线——————————————————————————————————————    

    
    
    **这一篇帖子有点错误，大家可以移步到第二集查看一下。**