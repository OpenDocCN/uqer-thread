# 全市场或板块的PB-PE-PS因子分位数绘图程序

编写了一个全市场或特定板块（如沪深300、创业板、中小板、银行行业、A股等）的PB、PE、PS等因子每日不同分位所对应数值的绘图程序.可以设定绘制的起始时间、需要绘制的因子及分位（目前绘制的是最高的5%、10%、20%分位，还可以扩展至每个十分位甚至百分位）。

从沪深300的PB因子图形可以看出2007、2015的绝代双骄以及之后的绝世双熊。2015年最高5%分位PB估值水平超过了2007年，但最高10%分位低于2007年。2017年8月1日沪深300的PB估值水平:高20%分位4.67；最高10%分位6.69，最高5%分位9.08。

从沪深300的PE图可以看出07、09、15三次牛市，从10%分位可以看出09年牛市强度明显弱于07年和15年。2017年8月1日沪深300的PE估值水平，最高20%分位49.40；最高10%分位71.72，最高5%分位106.34。

从创业板的PB分布图和PE分布图可以看出2012-2015创业板连续三年走强。2017年8月1日创业板PB估值水平，最高20%分位9.53（HS300 4.67）；最高10%分位9.53（HS300 6.69），最高5%分位11.26（HS300 9.08）。2017年8月1日创业板PE估值水平，最高20%分位97.92（HS300 49.40 ）；最高10%分位147.63（HS300 71.72），最高5%分位225.62（HS300 106.34）。

程序关键语句及参数。
# 设定股票池，有未来信息问题，但不用于量化策略回测，所以是可以的。
# 创业板-‘CYB’；中小板-‘ZXB’；A股-‘A’ 等等
universe = set_universe(‘HS300')    

#设置分位数，可以增加统计的分位            
Qt = ['0.8','0.9','0.95’] 

#提取标的交易日的PB（PE/PS）值
df = DataAPI.MktStockFactorsOneDayGet(tradeDate=d,secID=universe,field=u"tradeDate,PB").set_index("tradeDate")
