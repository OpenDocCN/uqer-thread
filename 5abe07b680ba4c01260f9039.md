# 交易所日历TradeCalGet与apply函数的应用

我有个策略用到数据表中两个日期的计算，这个计算不是简单的日期差，而是要排除不交易的天数，这就要用到"交易所交易日历"数据（DataAPI.TradeCalGet）。
但如果要排除每个股票停牌后天数，那计算量实在太大了，只好将就了。

统计两个日期在交易所日历中的天数，可以自定义一个函数实现（tradeDays）。
但是要用函数来计算表中的两个列，并生成代表天数的新列并不简单。
我尝试了用apply函数来迭代调用自定义函数tradeDays，可以得到需要的天数。
其中，关键是要定义两个全局变量TradeCal、dateList
测试程序贴出来，分享给大家。

测试生成的结果数据：
              tradeDate  closePrice nearHighDate nearlowDate  deltaDays
secID                                                                  
300008.XSHE  2017-01-03       9.831   2017-01-05  2017-01-05          1
300008.XSHE  2017-01-04      10.034   2017-01-03  2017-01-03          1
300008.XSHE  2017-01-05      10.046   2017-02-10  2017-01-03         24
300008.XSHE  2017-01-06       9.998   2017-01-03  2017-02-10         24
300008.XSHE  2017-01-09       9.962   2017-01-03  2017-01-03          1
603997.XSHG  2017-01-03      13.014   2017-01-05  2017-01-05          1
603997.XSHG  2017-01-04      13.146   2017-01-03  2017-02-10         24
603997.XSHG  2017-01-05      13.100   2017-01-05  2017-01-05          1
603997.XSHG  2017-01-06      12.948   2017-02-10  2017-01-05         22
603997.XSHG  2017-01-09      12.988   2017-01-03  2017-01-03          1
603999.XSHG  2017-01-03      14.958   2017-01-03  2017-01-05          3
603999.XSHG  2017-01-04      15.192   2017-02-10  2017-01-03         24
603999.XSHG  2017-01-05      15.007   2017-02-10  2017-02-10          1
603999.XSHG  2017-01-06      15.137   2017-01-03  2017-02-10         24
603999.XSHG  2017-01-09      15.660   2017-01-05  2017-01-03          3

